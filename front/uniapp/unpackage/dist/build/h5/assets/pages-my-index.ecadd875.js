import{o as t,c as e,w as s,m as a,n as i,a as n,i as o,y as r,v as l,x as u,q as p,C as f,z as c,D as d,E as g,s as h,e as m,d as y,F as b,b as $,h as _,r as w,B as x}from"./index-d86fb874.js";import{_ as C,a as N}from"./uni-list.51fc99f0.js";import{_ as j,r as k}from"./uni-app.es.929e2abd.js";const v="uni-col";const L=j({name:"uniCol",props:{span:{type:Number,default:24},offset:{type:Number,default:-1},pull:{type:Number,default:-1},push:{type:Number,default:-1},xs:[Number,Object],sm:[Number,Object],md:[Number,Object],lg:[Number,Object],xl:[Number,Object]},data:()=>({gutter:0,sizeClass:"",parentWidth:0,nvueWidth:0,marginLeft:0,right:0,left:0}),created(){let t=this.$parent;for(;t&&"uniRow"!==t.$options.componentName;)t=t.$parent;this.updateGutter(t.gutter),t.$watch("gutter",(t=>{this.updateGutter(t)}))},computed:{sizeList(){let{span:t,offset:e,pull:s,push:a}=this;return{span:t,offset:e,pull:s,push:a}},pointClassList(){let t=[];return["xs","sm","md","lg","xl"].forEach((e=>{const s=this[e];"number"==typeof s?t.push(`${v}-${e}-${s}`):"object"==typeof s&&s&&Object.keys(s).forEach((a=>{t.push("span"===a?`${v}-${e}-${s[a]}`:`${v}-${e}-${a}-${s[a]}`)}))})),t.join(" ")}},methods:{updateGutter(t){t=Number(t),isNaN(t)||(this.gutter=t/2)}},watch:{sizeList:{immediate:!0,handler(t){let e=[];for(let s in t){const a=t[s];!a&&0!==a||-1===a||e.push("span"===s?`${v}-${a}`:`${v}-${s}-${a}`)}this.sizeClass=e.join(" ")}}}},[["render",function(r,l,u,p,f,c){const d=o;return t(),e(d,{class:i(["uni-col",f.sizeClass,c.pointClassList]),style:n({paddingLeft:`${Number(f.gutter)}rpx`,paddingRight:`${Number(f.gutter)}rpx`})},{default:s((()=>[a(r.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}],["__scopeId","data-v-84ac5f6d"]]),S="uni-row",R="--";const O=j({name:"uniRow",componentName:"uniRow",props:{type:String,gutter:Number,justify:{type:String,default:"start"},align:{type:String,default:"top"},width:{type:[String,Number],default:750}},created(){},computed:{marginValue(){return this.gutter?-this.gutter/2:0},typeClass(){return"flex"===this.type?`${S+R}flex`:""},justifyClass(){return"start"!==this.justify?`${S+R}flex-justify-${this.justify}`:""},alignClass(){return"top"!==this.align?`${S+R}flex-align-${this.align}`:""}}},[["render",function(r,l,u,p,f,c){const d=o;return t(),e(d,{class:i(["uni-row",c.typeClass,c.justifyClass,c.alignClass]),style:n({marginLeft:`${Number(c.marginValue)}rpx`,marginRight:`${Number(c.marginValue)}rpx`})},{default:s((()=>[a(r.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"])}],["__scopeId","data-v-9ff25b7f"]]);const z=j({data:()=>({isLogin:!1,userinfo:{}}),onShow(){var t=this;r().globalData.checkLogin()&&(t.isLogin=!0,l.get(u.getApi("myProfile"),null,(function(e){0==e.code?t.userinfo=e.data:p.error(e.message)}),null))},methods:{goto:function(t){f({url:t})},startReporting:function(t){var e=t.value?1:0;l.post(u.getApi("myEdit"),{is_reporting:e},(function(t){if(0==t.code){let t=c(r().globalData.loginTokenKey);if(t){var s=JSON.parse(t);s.user.is_reporting=e,d(r().globalData.loginTokenKey,JSON.stringify(s))}}else p.error(t.message)}),{"Content-Type":"application/json"})},logout:function(){l.post(u.getApi("myLogout"),null,(function(t){if(0==t.code)try{g(),h({url:"/pages/index/index"})}catch(e){p.error(e)}else p.error(t.message)}),{"Content-Type":"application/json"})}}},[["render",function(a,i,n,r,l,u){const p=k(w("uni-list-item"),C),f=k(w("uni-list"),N),c=o,d=x,g=k(w("uni-col"),L),h=k(w("uni-row"),O);return t(),m(b,null,[l.isLogin?(t(),e(c,{key:0,class:"vh-100"},{default:s((()=>[$(c,{class:"mb-10"},{default:s((()=>[$(f,null,{default:s((()=>[$(p,{ellipsis:"1",title:l.userinfo.username,showArrow:"true",note:l.userinfo.desc,thumb:l.userinfo.avatar,"thumb-size":"lg",rightText:l.userinfo.role_name,clickable:"",onClick:i[0]||(i[0]=t=>u.goto("/pages/my/edit"))},null,8,["title","note","thumb","rightText"])])),_:1})])),_:1}),2==l.userinfo.role_id?(t(),e(c,{key:0,class:"mb-10"},{default:s((()=>[$(f,null,{default:s((()=>[$(p,{title:"Start Reporting",note:"When the switch is opened, your coordinate will be reported to the server",showSwitch:"true",switchChecked:1==l.userinfo.is_reporting,onSwitchChange:u.startReporting},null,8,["switchChecked","onSwitchChange"]),$(p,{title:"Mark Station",note:"Report the coordinate of the station, the station will be shown on the map",showArrow:"",link:"",to:"/pages/station/mark"})])),_:1})])),_:1})):y("",!0),$(c,{class:"px-10"},{default:s((()=>[$(d,{type:"default",onClick:u.logout},{default:s((()=>[_("Logout")])),_:1},8,["onClick"])])),_:1})])),_:1})):y("",!0),l.isLogin?y("",!0):(t(),e(c,{key:1,class:"d-flex flex-column align-items-center justify-content-center vh-100"},{default:s((()=>[$(h,{class:"w-100",gutter:"30"},{default:s((()=>[$(g,{xs:{span:20,push:2},sm:{span:16,push:4},md:{span:10,push:2},lg:{span:8,push:4},xl:{span:6,push:6}},{default:s((()=>[$(d,{type:"primary",onClick:i[1]||(i[1]=t=>u.goto("/pages/my/login"))},{default:s((()=>[_("Login")])),_:1})])),_:1}),$(g,{xs:{span:20,push:2},sm:{span:16,push:4},md:{span:10,push:2},lg:{span:8,push:4},xl:{span:6,push:6}},{default:s((()=>[$(d,{type:"primary",onClick:i[2]||(i[2]=t=>u.goto("/pages/my/register"))},{default:s((()=>[_("Register")])),_:1})])),_:1})])),_:1})])),_:1}))],64)}],["__scopeId","data-v-71da25d0"]]);export{z as default};
